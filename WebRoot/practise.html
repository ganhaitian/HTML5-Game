<!DOCTYPE html>
<html>
  <head>
    <title>HTML5 Practise</title>
	
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="./common/jquery/jquery-1.8.1.min.js" ></script>
    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->
	<style>
		canvas{
			border:1px solid black;
		}
		
		.wrapper{
			margin:0 auto;
			height:800px;
			width:480px;
		}
		
	</style>
	<script type="text/javascript">
	
		var imgBlocks=[];
		var indexs=[];
		
		for(var index=0;index<12;index++)
			indexs.push(index);	
		
		var puzzleImage=new Image();
		puzzleImage.src="./test.jpg";
	
		BLOCK_WIDTH=107;
		BLOCK_HEIGHT=134;
		
		mainPanel={
			backColor:'#000000',
			draw:function(){
				context.fillStyle=this.backColor;
				context.fillRect(0,0,320,533);
				this.renderChildren();
			},
			renderChildren:function(){
				$.each(this.items,function(child){
					child.draw();
				});
			},
			items:[],
			add:function(child){
				this.items.push(child);
			}
		};
		
		block=function(v,h,v_s,h_s){
			this.v=v;
			this.h=h;
			this.v_s=v_s;
			this.h_s=h_s;
			
			this.draw=function(){
				context.drawImage(
					puzzleImage,
					this.h*BLOCK_WIDTH,
					this.v*BLOCK_HEIGHT,
					BLOCK_WIDTH,
					BLOCK_HEIGHT,
					this.h_s*BLOCK_WIDTH,
					this.v_s*BLOCK_HEIGHT,
					BLOCK_WIDTH,
					BLOCK_HEIGHT);
			};
		};
	
		$(document).ready(function(){
			canvas=$('#lookwhatIdrew')[0];
			
			context=canvas.getContext("2d");
			
			canvas.onmousedown=function(e){
				control=true;
				//alert('down');
			};
			
			canvas.onmouseup=function(e){
				control=false;
				//alert('up');
			};
			
			canvas.onmousemove=function(e){
				
			};
			//context.drawImage(puzzleImage,0,0,320,533);
			initImage();
			
			refresh();
			
			context.stroke();
			//context.fillRect(10,10,100,100);
			//drawDiagonal();
		});
		
		function initImage(){
			var random;
			var v;
			var h;
			var v_s;
			var h_s;
			while(indexs.length>0){
				random=Math.floor(Math.random()*11);
				v=Math.floor(indexs[random]/3);
				h=indexs[random]%3;
				v_s=Math.floor((indexs.length-1)/3);
				h_s=(indexs.length-1)%3;
				
				mainPanel.add(new block(v,h,v_s,h_s));
				//context.drawImage(
				//	puzzleImage,
				//	h*BLOCK_WIDTH,
				//	v*BLOCK_HEIGHT,
				//	BLOCK_WIDTH,
				//	BLOCK_HEIGHT,
				//	h_s*BLOCK_WIDTH,
				//	v_s*BLOCK_HEIGHT,
				//	BLOCK_WIDTH,
				//	BLOCK_HEIGHT);
				indexs.splice(random,1);
			}
		}
		
		function refresh(){
			mainPanel.draw();
			context.fill();
		}
		
		function drawDiagonal(){
			var context=$('#lookwhatIdrew')[0].getContext('2d');
			
			context.beginPath();
			context.moveTo(70,140);
			context.lineTo(140,70);
			
			context.stroke();
		}
		
	</script>
  </head>
  
  <body>
  	 <div class="wrapper" id="main" >
     	<canvas id="lookwhatIdrew" width="320" height="533" ></canvas>
     </div>
  </body>
</html>
